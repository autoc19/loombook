{
  "id": "snapshot_1766629233813_sxwahdadb",
  "approvalId": "approval_1766629233792_e29f318zq",
  "approvalTitle": "Review steering: product.md",
  "version": 1,
  "timestamp": "2025-12-25T02:20:33.813Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Product Steering\r\n\r\n## 1. 背景與願景\r\n\r\n本專案是「企業級線上書店與交易平台」的後端系統。短期目標不是一次完成所有企業級能力，而是以可驗收的最小閉環（Level 0）建立可演進的工程骨架，作為後續等級（Level 1+）擴展的基礎。\r\n\r\n核心願景：構建一個 **高併發、高一致性、可追溯** 的企業級交易平台後端。\r\n\r\n## 2. Level 0 的產品目標\r\n\r\nLevel 0 的交付物聚焦在：\r\n\r\n- 可運行、可測試、可演進的最小系統骨架\r\n- 驗證六角架構/DDD 邊界與依賴方向\r\n- 建立強制 TDD 的交付紀律\r\n\r\nLevel 0 必須提供的最小業務閉環：\r\n\r\n- 商品建立\r\n- 依商品 ID 查詢\r\n- 最小可觀測性門檻：健康檢查（`/actuator/health`）\r\n\r\n## 3. 使用者/角色（Level 0）\r\n\r\nLevel 0 僅需要覆蓋最小角色敘事，用於界定 API 行為：\r\n\r\n- 平台呼叫端（可視為後台/管理端或整合端）建立商品\r\n- 平台呼叫端以 `id` 查詢商品\r\n\r\n## 4. 範圍（Scope）\r\n\r\n### 4.1 Level 0 需要做（必做）\r\n\r\n- 商品資料必須真實持久化到資料庫（H2 in-memory + JPA），不得只存於記憶體 Map\r\n- 嚴格遵守六角架構分層（Domain / Application / Infrastructure / API），Domain 必須完全框架無關\r\n- 強制 TDD：每個能力必須先寫測試再寫實作，且遵循固定開發順序\r\n- 提供最小 ArchUnit 守門規則（至少兩條）\r\n\r\n### 4.2 Level 0 不做（明確禁止）\r\n\r\n- 身分與權限：不得引入 Spring Security/OAuth2/RBAC/多租戶\r\n- 訂單/支付/庫存扣減/防超賣/Saga 等交易能力\r\n- Kafka、Structured Concurrency、Testcontainers、E2E、壓測報告、OpenAPI 檔案\r\n- 商品詳情聚合查詢（並行拉取庫存/評論/促銷）、降級、快速失敗等 Level 1+ 能力\r\n\r\n## 5. 成功標準（Definition of Done）\r\n\r\n- API 契約不得偏離 Level 0 FRS：\r\n  - `POST /api/products`：201/400\r\n  - `GET /api/products/{id}`：200/404\r\n  - `GET /actuator/health`：200（UP）\r\n- 可執行並通過：\r\n  - `./gradlew test`\r\n  - `./gradlew bootRun`（監聽 8080）\r\n- 架構合規：\r\n  - Domain 不依賴 Spring\r\n  - API 不依賴 Infrastructure\r\n- 測試合規：每個能力至少具備\r\n  - Domain 測試（VO 不變性）\r\n  - UseCase 測試（CreateProduct / GetProductById）\r\n  - API 測試（201/400/200/404）\r\n\r\n## 6. 風險與邊界\r\n\r\n- Level 0 的「企業級」主要體現在工程邊界與可演進性（架構、測試、依賴方向），而非功能完整度。\r\n- 任何超出 Level 0 FRS 的擴展（新增端點/新增模組/引入未要求框架）一律視為偏離範圍。\r\n",
  "fileStats": {
    "size": 2652,
    "lines": 67,
    "lastModified": "2025-12-25T02:19:59.101Z"
  },
  "comments": []
}